{% extends 'base/base.html' %}

{% block title %}{{ load }} - TruK{% endblock %}

{% block content %}
<div class="load-detail">
    <div class="page-header">
        <h1>Detalhes da Carga</h1>
        <div class="actions">
            <a href="{% url 'loads:edit' load.pk %}" class="btn btn-secondary">Editar</a>
            <a href="{% url 'loads:delete' load.pk %}" class="btn btn-danger">Deletar</a>
        </div>
    </div>
    
    <div class="status-section">
        <span class="status-badge status-{{ load.status }} large">{{ load.get_status_display }}</span>
        
        {% if load.status == 'pendente' %}
        <a href="{% url 'loads:status_change' load.pk 'iniciar' %}" class="btn btn-primary">Iniciar Carga</a>
        {% elif load.status == 'em_andamento' %}
        <a href="{% url 'loads:status_change' load.pk 'concluir' %}" class="btn btn-success">Concluir</a>
        <a href="{% url 'loads:status_change' load.pk 'falhar' %}" class="btn btn-warning">Marcar como Falhada</a>
        {% endif %}
    </div>
    
    <div class="detail-grid">
        <div class="detail-card">
            <h2>Rota</h2>
            <div class="route-info">
                <div class="location">
                    <strong>üìç Origem:</strong>
                    <p>{{ load.origem_cidade }}, {{ load.origem_pais }}</p>
                </div>
                <div class="arrow">‚Üí</div>
                <div class="location">
                    <strong>üéØ Destino:</strong>
                    <p>{{ load.destino_cidade }}, {{ load.destino_pais }}</p>
                </div>
            </div>
        </div>
        
        <div class="detail-card">
            <h2>Informa√ß√µes da Carga</h2>
            <dl>
                <dt>Tipo de Carga:</dt>
                <dd>{{ load.tipo_carga }}</dd>
                
                <dt>Tipo de Trailer:</dt>
                <dd>{{ load.get_tipo_trailer_display|default:"N/A" }}</dd>
                
                {% if load.peso_toneladas %}
                <dt>Peso:</dt>
                <dd>{{ load.peso_toneladas }} toneladas</dd>
                {% endif %}
                
                <dt>Dist√¢ncia:</dt>
                <dd>{{ load.distancia_km }} km</dd>
            </dl>
        </div>
        
        <div class="detail-card">
            <h2>Financeiro</h2>
            <dl>
                <dt>Pagamento:</dt>
                <dd class="highlight-success">‚Ç¨{{ load.pagamento_eur }}</dd>
                
                <dt>Multas:</dt>
                <dd class="highlight-danger">‚Ç¨{{ load.multas }}</dd>
                
                <dt>Lucro L√≠quido:</dt>
                <dd class="highlight-info"><strong>‚Ç¨{{ load.lucro_liquido }}</strong></dd>
            </dl>
        </div>
        
        <div class="detail-card">
            <h2>Detalhes T√©cnicos</h2>
            <dl>
                <dt>Dano:</dt>
                <dd>{{ load.dano_percentual }}%</dd>
                
                <dt>Efici√™ncia:</dt>
                <dd>{{ load.eficiencia }}%</dd>
                
                {% if load.combustivel_litros %}
                <dt>Combust√≠vel:</dt>
                <dd>{{ load.combustivel_litros }} litros</dd>
                {% endif %}
                
                {% if load.tempo_viagem %}
                <dt>Tempo de Viagem:</dt>
                <dd>{{ load.tempo_viagem }}</dd>
                {% endif %}
            </dl>
        </div>
        
        <div class="detail-card">
            <h2>Datas</h2>
            <dl>
                <dt>Criado em:</dt>
                <dd>{{ load.data_criacao|date:"d/m/Y H:i" }}</dd>
                
                {% if load.data_inicio %}
                <dt>Iniciado em:</dt>
                <dd>{{ load.data_inicio|date:"d/m/Y H:i" }}</dd>
                {% endif %}
                
                {% if load.data_conclusao %}
                <dt>Conclu√≠do em:</dt>
                <dd>{{ load.data_conclusao|date:"d/m/Y H:i" }}</dd>
                {% endif %}
            </dl>
        </div>
        
        <div class="detail-card">
            <h2>Motorista</h2>
            <p><strong>{{ load.motorista.get_full_name|default:load.motorista.username }}</strong></p>
            <p class="role-badge">{{ load.motorista.get_role_display }}</p>
        </div>
    </div>
    
    {% if load.screenshot %}
    <div class="screenshot-section">
        <h2>Screenshot</h2>
        <img src="{{ load.screenshot.url }}" alt="Screenshot da carga" class="screenshot-img">
    </div>
    {% endif %}
    
    {% if load.notas %}
    <div class="notes-section">
        <h2>Notas</h2>
        <p>{{ load.notas|linebreaks }}</p>
    </div>
    {% endif %}
</div>
{% endblock %}
